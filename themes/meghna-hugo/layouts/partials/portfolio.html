{{ $menu := (index .Site.Data .Site.Language.Lang).menu }}

{{ if $menu.enable }}
{{"<!-- Portfolio Section -->" | safeHTML}}
<section class="portfolio section" id="carta">
	<div class="container">
		<div class="row ">
			<div class="col-xl-12">
				{{"<!-- section title -->" | safeHTML}}
				<div class="title text-center">
					<h2>{{ with $menu.title }}{{ index (split . " ") 0 }}{{ end }}<span class="color">
							{{ with $menu.title }}{{ index (split . " ") 1 }}{{ end }}</span></h2>
					<div class="border-meghna"></div>
                    <p>{{ with $menu.description }}{{ . }}{{ end }}</p>
                </div>
				{{"<!-- /section title -->" | safeHTML}}
			</div>
		</div>

		<div class="row">
			<div class="col-lg-12">
                <!-- TODO maximum category width -->
                {{"<!-- First level -->" | safeHTML}}
				<div class="btn-group btn-group-toggle portfolio-filter menu-level-one justify-content-center d-flex flex-wrap" data-toggle="buttons">
					<label class="btn active">
						<input type="radio" autocomplete="off" name="shuffle-filter" value="all" checked>{{ i18n "all"}}
					</label>
                    {{ range $menu.categorias }}
					<label class="btn">
                        <input type="radio" autocomplete="off" name="shuffle-filter" value="{{ .nombre | urlize }}">{{ .nombre }}
					</label>
					{{ end }}
				</div>

                {{"<!-- Second level -->" | safeHTML}}
                {{ range $parent := $menu.categorias }}
                {{ if .subcategorias }}
				<div class="btn-group btn-group-toggle portfolio-filter menu-level-two justify-content-center d-none flex-wrap" parent="{{ $parent.nombre | urlize }}" data-toggle="buttons">
					<label class="btn active">
                        <input type="radio" autocomplete="off" name="shuffle-filter" value="{{ $parent.nombre | urlize }}" checked>{{ i18n "all"}}
					</label>
                    {{ range .subcategorias }}
					<label class="btn">
                        <input type="radio" autocomplete="off" name="shuffle-filter" value="{{ .nombre | urlize }}">{{ .nombre }}
					</label>
                    {{ end }}
				</div>
                {{ end }}
                {{ end }}

                {{"<!-- First level -->" | safeHTML}}
                {{ range $menu.categorias }}
                {{ range $parent := .subcategorias }}
                {{ if .subcategorias }}
				<div class="btn-group btn-group-toggle portfolio-filter menu-level-three justify-content-center d-none flex-wrap" parent="{{ $parent.nombre | urlize }}" data-toggle="buttons">
					<label class="btn active">
                        <input type="radio" autocomplete="off" name="shuffle-filter" value="{{ $parent.nombre | urlize }}" checked/>{{ i18n "all"}}
					</label>
                    {{ range .subcategorias }}
					<label class="btn">
                        <input type="radio" autocomplete="off" name="shuffle-filter" value="{{ .nombre | urlize }}">{{ .nombre }}
					</label>
                    {{ end }}
				</div>
                {{ end }}
                {{ end }}
                {{ end }}
			</div>
		</div>

		<div class="row shuffle-wrapper justify-content-center">
            {{ $i := 0 }}
			{{ range (shuffle $menu.items) }}

            {{ $fields := dict $menu.titulo_ingredientes .ingredientes $menu.titulo_alergenos .alergenos $menu.titulo_txt_aclaraciones .txt_aclaraciones $menu.titulo_txt_temporal .txt_temporal $menu.titulo_grad_alcoholica .grad_alcoholica $menu.titulo_vol_ml .vol_ml $menu.titulo_edul_gr .edul_gr }}

            {{ $standalone := true }}
            {{ range $_, $data := $fields }}
                {{ if ne $data nil }}
                    {{ $standalone = false }}
                {{ end }}
            {{ end }}

			{{"<!-- Portfolio item -->" | safeHTML}}
			<figure class="col-lg-4 shuffle-item" data-groups="[{{ range $index, $element:= .categorias }}{{ if ne $index 0 }},{{ end }}&quot;{{ . | urlize }}&quot;{{ end }}]">
				<div class="portfolio-block mb-4">
                    <a class="open-popup-{{ if $standalone }}standalone{{ else }}inline{{ end }}" href="{{ if $standalone }}{{ .imagen | relURL }}{{ else }}#carta-img{{ $i }}{{ end }}" data-effect="mfp-with-zoom">
                        <!-- <img class="lozad img-fluid" data-src="{{ .imagen_pequenya | absURL }}" alt="{{ .nombre }}"> -->
                        <img class="img-fluid" src="{{ .imagen_pequenya | absURL }}" alt="{{ .nombre }}">
                        <div class="caption">
                            <span>{{ .nombre }}</span>
                            <i class="ti-search"></i>
                        </div>
                    </a>
				</div>
			</figure>

			{{"<!-- Portfolio pop-up with more data -->" | safeHTML}}
            <div id="carta-img{{ $i }}" class="mfp-hide">
                {{ if not $standalone }}
                <div class="popup-content">
                    <div class="popup-img">
                        <img class="lozad" data-src="{{ .imagen | relURL }}" alt="{{ .nombre }}">
                    </div>
                    <div class="popup-details">
                        <h1>{{ .nombre }}</h1>
                        {{ range $title, $data := $fields }}
                            {{ with $data }}
                            <p><b>{{ $title | markdownify }}:</b> {{ . }}</p>
                            {{ end }}
                        {{ end }}
                    </div>
                </div>
                {{ end }}
            </div>
            {{ $i = add $i 1 }}
			{{ end }}
		</div>
	</div>
</section>
{{"<!-- /Portfolio -->" | safeHTML}}
{{ end }}
