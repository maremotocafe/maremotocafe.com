{{ $menu := (index .Site.Data .Site.Language.Lang).menu }}

{{ if $menu.enable }}
{{"<!-- Portfolio Section -->" | safeHTML}}
<section class="portfolio section" id="carta">
	<div class="container">
		<div class="row ">
			<div class="col-xl-12">
				{{"<!-- section title -->" | safeHTML}}
				<div class="title text-center">
					<h2>{{ with $menu.title }}{{ index (split . " ") 0 }}{{ end }}<span class="color">
							{{ with $menu.title }}{{ index (split . " ") 1 }}{{ end }}</span></h2>
					<div class="border-meghna"></div>
                    <p>{{ with $menu.description }}{{ . }}{{ end }}</p>
                </div>
				{{"<!-- /section title -->" | safeHTML}}
			</div>
		</div>

		<div class="row">
			<div class="col-lg-12">
                {{"<!-- First level -->" | safeHTML}}
				<div class="btn-group btn-group-toggle portfolio-filter justify-content-center d-flex flex-wrap" filter-level="1" data-toggle="buttons">
					<label class="btn default active">
                        <input type="radio" autocomplete="off" name="shuffle-filter" filter-value="all" checked>
                        <i class="{{ $menu.icono_todo }}"></i>
                        <span>{{ i18n "all"}}</span>
					</label>
                    {{ range $menu.categorias }}
					<label class="btn">
                        <input type="radio" autocomplete="off" name="shuffle-filter" filter-value="{{ .nombre | urlize }}">
                        <i class="{{ .icono }}"></i>
                        <span>{{ .nombre }}</span>
					</label>
					{{ end }}
				</div>

                {{"<!-- Second level -->" | safeHTML}}
                {{ range $parent := $menu.categorias }}
                {{ if .subcategorias }}
				<div class="btn-group btn-group-toggle portfolio-filter justify-content-center d-none flex-wrap" filter-level="2" filter-parent="{{ $parent.nombre | urlize }}" data-toggle="buttons">
					<label class="btn default active">
                        <input type="radio" autocomplete="off" name="shuffle-filter" filter-value="{{ $parent.nombre | urlize }}" checked>
                        <i class="{{ $menu.icono_todo }}"></i>
                        <span>{{ i18n "all"}}</span>
					</label>
                    {{ range .subcategorias }}
					<label class="btn">
                        <input type="radio" autocomplete="off" name="shuffle-filter" filter-value="{{ .nombre | urlize }}">
                        <i class="{{ $parent.icono }}"></i>
                        <span>{{ .nombre }}</span>
					</label>
                    {{ end }}
				</div>
                {{ end }}
                {{ end }}

                {{"<!-- Third level -->" | safeHTML}}
                {{ range $grandparent := $menu.categorias }}
                {{ range $parent := .subcategorias }}
                {{ if .subcategorias }}
				<div class="btn-group btn-group-toggle portfolio-filter justify-content-center d-none flex-wrap" filter-level="3" filter-parent="{{ $parent.nombre | urlize }}" data-toggle="buttons">
					<label class="btn default active">
                        <input type="radio" autocomplete="off" name="shuffle-filter" filter-value="{{ $parent.nombre | urlize }}" checked/>
                        <i class="{{ $menu.icono_todo }}"></i>
                        <span>{{ i18n "all"}}</span>
					</label>
                    {{ range .subcategorias }}
					<label class="btn">
                        <input type="radio" autocomplete="off" name="shuffle-filter" filter-value="{{ .nombre | urlize }}">
                        <i class="{{ $grandparent.icono }}"></i>
                        <span>{{ .nombre }}</span>
					</label>
                    {{ end }}
				</div>
                {{ end }}
                {{ end }}
                {{ end }}
			</div>
		</div>

		<div class="row shuffle-wrapper justify-content-center">
            {{ $i := 0 }}
			{{ range $item := (shuffle $menu.items) }}

            {{ $standalone := true }}
            {{ range $menu.nombres_datos }}
                {{ if ne (index $item .) nil }}
                    {{ $standalone = false }}
                {{ end }}
            {{ end }}

			{{"<!-- Portfolio item -->" | safeHTML}}
			<figure class="col-lg-4 shuffle-item" data-groups='[{{ range $index, $element:= .categorias }}{{ if ne $index 0 }},{{ end }}"{{ . | urlize }}"{{ end }}]'>
				<div class="portfolio-block mb-4">
                    <a class="open-popup-{{ if $standalone }}standalone{{ else }}inline{{ end }}" href="{{ if $standalone }}{{ .imagen | relURL }}{{ else }}#carta-img{{ $i }}{{ end }}">
                        <!-- <img class="lozad img-fluid" data-src="{{ .imagen_pequenya | absURL }}" alt="{{ .nombre }}"> -->
                        <img class="img-fluid" src="{{ .imagen_pequenya | absURL }}" alt="{{ .nombre }}">
                        <div class="caption">
                            <span>{{ .nombre }}</span>
                            <i class="las la-search"></i>
                        </div>
                    </a>
				</div>
			</figure>

			{{"<!-- Portfolio pop-up with more data -->" | safeHTML}}
            <div id="carta-img{{ $i }}" class="mfp-hide">
                {{ if not $standalone }}
                <div class="popup-content">
                    <div class="popup-img">
                        <img class="lozad" data-src="{{ .imagen | relURL }}" alt="{{ .nombre }}">
                    </div>
                    <div class="popup-details">
                        <h1>{{ .nombre }}</h1>
                        {{ range $menu.nombres_datos }}
                            {{ if (index $item .) }}
                            <p>
                            <i class="field-icon {{ index $menu.iconos_datos . }}"></i>
                            <span class="field-title">{{ (index $menu.titulos_datos .) }}: </span>
                            <span class="field-description">{{ (index $item .) | markdownify }}</span>
                            </p>
                            {{ end }}
                        {{ end }}
                    </div>
                </div>
                {{ end }}
            </div>
            {{ $i = add $i 1 }}
			{{ end }}
		</div>
	</div>
</section>
{{"<!-- /Portfolio -->" | safeHTML}}
{{ end }}
